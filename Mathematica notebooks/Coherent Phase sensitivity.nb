(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    123729,       3476]
NotebookOptionsPosition[     97083,       2994]
NotebookOutlinePosition[    111441,       3293]
CellTagsIndexPosition[    111398,       3290]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["General phase sensitivity analysis for a coherent input", "Title",
 CellChangeTimes->{{3.9625227301049232`*^9, 3.962522745593191*^9}, {
  3.9625876302713833`*^9, 
  3.9625876338466988`*^9}},ExpressionUUID->"6f2e34dd-c865-574f-8d42-\
ce6a44c76a97"],

Cell["Setting number of modes in \[OpenCurlyDoubleQuote]NumModes\
\[CloseCurlyDoubleQuote]", "Text",
 CellChangeTimes->{{3.8717415711918364`*^9, 3.8717416382153935`*^9}, {
  3.8717426317406073`*^9, 
  3.871742646068309*^9}},ExpressionUUID->"5cf2beed-82cd-a947-85d2-\
8e59f61168db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumModes", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.8717416402182617`*^9, 3.8717416468485775`*^9}, 
   3.926420295590127*^9, {3.9531175365108147`*^9, 3.9531175365897274`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"5304e165-6b52-c348-b3e0-6cb55a8ad531"],

Cell["\<\
Defining a function which generates operator vector, for operator \
\[OpenCurlyDoubleQuote]O\[CloseCurlyDoubleQuote] with \
\[OpenCurlyDoubleQuote]NumModes\[CloseCurlyDoubleQuote] number of modes\
\>", "Text",
 CellChangeTimes->{{3.871742651051956*^9, 
  3.871742722868092*^9}},ExpressionUUID->"7ea7ecf5-e658-9e48-bfd2-\
b9fa81746cc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OpVectorGenerator1", "[", 
    RowBox[{"O_", ",", "NumModes_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["O", "q"], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "1", ",", "NumModes"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8717418659997*^9, 3.87174188135172*^9}, {
  3.8717419151122556`*^9, 3.871741915216689*^9}, {3.871743362219713*^9, 
  3.8717433678276873`*^9}, {3.871743769778514*^9, 3.8717437726104584`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"d5ccd494-7a74-6b45-a423-502dbf4a113b"],

Cell["\<\
Defining a function which generates the Hermitian conjugate operator vector, \
for operator \[OpenCurlyDoubleQuote]O\[CloseCurlyDoubleQuote] with \
\[OpenCurlyDoubleQuote]NumModes\[CloseCurlyDoubleQuote] number of modes\
\>", "Text",
 CellChangeTimes->{{3.871742651051956*^9, 3.8717427413560085`*^9}, {
  3.871742776066856*^9, 
  3.871742792786557*^9}},ExpressionUUID->"f0cb0ebf-639d-f940-bad1-\
2db7f2568499"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OpVectorGenerator1HC", "[", 
    RowBox[{"O_", ",", "NumModes_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      SuperscriptBox[
       SubscriptBox["O", "q"], "\[Dagger]"], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "1", ",", "NumModes"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8717421324872065`*^9, 3.871742148943204*^9}, {
  3.8717437767229786`*^9, 3.871743780482274*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"8fecdd1d-19f3-b04a-8a8d-4019ff377048"],

Cell["\<\
Defining a function which generates input operator vector, for operator \
\[OpenCurlyDoubleQuote]O\[CloseCurlyDoubleQuote] with \
\[OpenCurlyDoubleQuote]NumModes\[CloseCurlyDoubleQuote] number of modes which \
includes Hermitian conjugated components.\
\>", "Text",
 CellChangeTimes->{{3.871742651051956*^9, 3.871742722868092*^9}, {
  3.871742823068081*^9, 3.871742856019473*^9}, {3.871742957803437*^9, 
  3.871743033563465*^9}},ExpressionUUID->"ce6db00c-40cb-854e-bf35-\
8196d8ad643c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OpVectorGenerator2", "[", 
    RowBox[{"O_", ",", "NumModes_"}], "]"}], ":=", 
   RowBox[{"Join", " ", "[", 
    RowBox[{
     RowBox[{"OpVectorGenerator1", "[", 
      RowBox[{"O", ",", "NumModes"}], "]"}], ",", 
     RowBox[{"OpVectorGenerator1HC", "[", 
      RowBox[{"O", ",", "NumModes"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.871741906224375*^9, 3.8717419063359785`*^9}, {
  3.8717419405841355`*^9, 3.871741969035994*^9}, {3.8717420607830763`*^9, 
  3.8717420704607763`*^9}, {3.8717421658464527`*^9, 3.8717421801113424`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"d3af0d0c-3305-934b-8da3-53e4706d6cd8"],

Cell["\<\
Defining a function that creates a vector of length \
(\[OpenCurlyDoubleQuote]End\[CloseCurlyDoubleQuote]-\[OpenCurlyDoubleQuote]\
Beginning\[CloseCurlyDoubleQuote]+1) from existing vector \
\[OpenCurlyDoubleQuote]V\[CloseCurlyDoubleQuote], between the entries \
\[OpenCurlyDoubleQuote]beginning\[CloseCurlyDoubleQuote] to \
\[OpenCurlyDoubleQuote]end\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.8717430410297766`*^9, 3.8717430436596622`*^9}, {
  3.871743922168315*^9, 
  3.8717440417045784`*^9}},ExpressionUUID->"17ae813a-e6b4-0042-af6f-\
1d961e361e2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VecRet", "[", 
    RowBox[{"V_", ",", "Beginning_", ",", "End_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", "V", ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"q", ",", "1"}], "]"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", "Beginning", ",", "End"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8717430936927767`*^9, 3.87174317466077*^9}, 
   3.8717438487617655`*^9, {3.871743908041519*^9, 3.871743913978593*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"eadb7f4c-8f08-054e-8475-baa50b7bdf75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ain", "=", 
   RowBox[{"OpVectorGenerator1", "[", 
    RowBox[{"a", ",", "NumModes"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9531179986717243`*^9, 3.953118022533533*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"15d89ab4-0c43-ba4d-a561-2e6f1a5bc86d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alpha", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SqrtBox["\[Mu]"]},
       {
        SqrtBox["\[Nu]"]},
       {"0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.962522469216501*^9, 3.9625224783544807`*^9}, {
  3.9625225209739017`*^9, 3.962522536099066*^9}, {3.962522589706356*^9, 
  3.9625226019213257`*^9}, {3.9634559974474487`*^9, 3.9634560159092445`*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"2322cf5a-345d-1841-bb4b-97cb2de62e4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ain", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.95311802568038*^9, 3.953118027979494*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"df8686ca-3f89-c44d-9e11-c81b80116ae6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["a", "1"]},
     {
      SubscriptBox["a", "2"]},
     {
      SubscriptBox["a", "3"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9531180284504547`*^9, 3.9625232180227737`*^9, 
  3.9634560410825443`*^9, 3.9634632155490875`*^9, 3.963483341072601*^9, 
  3.9638002946843405`*^9, 3.963800352226855*^9, 3.9644073566614313`*^9, 
  3.9663159527451687`*^9},
 CellLabel->
  "Out[215]//MatrixForm=",ExpressionUUID->"82701a33-a98e-400d-8571-\
bb616dc5c840"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ain2", "=", 
   RowBox[{"ain", "+", "alpha"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.962523188609537*^9, 3.9625231947442265`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"3d7e5c28-8881-0544-a83a-be6d8cd970da"],

Cell[CellGroupData[{

Cell["Optical components", "Subchapter",
 CellChangeTimes->{{3.8448435565116577`*^9, 3.844843564815401*^9}, {
  3.9265804230416975`*^9, 3.926580425392726*^9}, {3.9531175916328983`*^9, 
  3.953117599508703*^9}},ExpressionUUID->"55ce9900-c65b-5b44-9af7-\
c1587593403c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bs", "[", 
    RowBox[{"r_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"r", "t"},
      {"t", 
       RowBox[{"-", "r"}]}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9319466446019316`*^9, 3.9319466653440194`*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"1679bb83-f99b-4a45-bc01-1fdd92b51eec"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MatrixProduct", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"a", ".", "b"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.931948288529949*^9, 3.931948302312149*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"e2b49c80-e67e-4244-8f62-45e81f3f60b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DirectSum", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"a", "0"},
       {"0", 
        RowBox[{" ", "b"}]}
      }], "\[NoBreak]", ")"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.931946559844675*^9, 3.931946606561411*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"81841688-c4de-1e45-a5ba-14bf2fdc74c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DS", "[", "m_", "]"}], ":=", 
   RowBox[{"DirectSum", "[", 
    RowBox[{"1", ",", "m"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.93194661104222*^9, 3.931946638360615*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"54624dbb-239a-294c-b0bb-aae8d02ab18c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DS", "[", 
   RowBox[{"bs", "[", 
    RowBox[{"r", ",", "t"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.931946672075774*^9, 3.931946682887507*^9}, {
  3.9531169974709454`*^9, 3.953116999204397*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"158cb033-5521-414e-8ecd-26efbac44f4b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "r", "t"},
     {"0", "t", 
      RowBox[{"-", "r"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9531170285160866`*^9, 3.9625232265454407`*^9, 
  3.963456041167329*^9, 3.9634632158730145`*^9, 3.9634833411091137`*^9, 
  3.9638002947735195`*^9, 3.9638003801017704`*^9, 3.9644073567093506`*^9, 
  3.966315952812499*^9},
 CellLabel->
  "Out[221]//MatrixForm=",ExpressionUUID->"0ca83c7f-e92e-4fab-a459-\
16eecb2c4690"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DirectSum", "[", 
   RowBox[{
    RowBox[{"bs", "[", 
     RowBox[{"r", ",", "t"}], "]"}], ",", "1"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.953117217600704*^9, 3.953117230797554*^9}},
 CellLabel->
  "In[222]:=",ExpressionUUID->"59c1afe6-7b81-a14e-b9f4-76f83b0b4325"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"r", "t", "0"},
     {"t", 
      RowBox[{"-", "r"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9531172313009834`*^9, 3.9625232265535774`*^9, 
  3.9634560411858683`*^9, 3.963463216033864*^9, 3.9634833411294065`*^9, 
  3.9638002948117266`*^9, 3.963800382474515*^9, 3.9644073567345448`*^9, 
  3.966315952831171*^9},
 CellLabel->
  "Out[222]//MatrixForm=",ExpressionUUID->"564083ed-4065-41c3-8548-\
eda61bd3e0e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BS", "[", 
    RowBox[{"r_", ",", "t_"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"r", "t", "0"},
       {"t", 
        RowBox[{"-", "r"}], "0"},
       {"0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.953117243073057*^9, 3.9531172612719345`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"a5588c37-ce57-5c49-9ca6-75e18ff59987"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"\[CurlyPhi]1_", ",", "\[CurlyPhi]2_"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]1"}]], "0", "0"},
       {"0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]2"}]], "0"},
       {"0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.844773367067548*^9, 3.8447734393399534`*^9}, 
   3.8593566788500338`*^9, {3.8594483655090876`*^9, 3.8594483884277525`*^9}, {
   3.9264216264643664`*^9, 3.9264216295043*^9}, {3.953117292920233*^9, 
   3.9531173138960533`*^9}},
 CellLabel->
  "In[224]:=",ExpressionUUID->"eeb940d2-dcde-5447-8105-bca944a24c15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DS", "[", 
    RowBox[{"bs", "[", 
     RowBox[{"tO", ",", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["tO", "2"]}]]}], "]"}], "]"}], ".", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       SubscriptBox["a", "1"]},
      {
       SubscriptBox["a", "2"]},
      {
       SubscriptBox["a", "3"]}
     }], "\[NoBreak]", ")"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.953117049783489*^9, 3.9531171317878265`*^9}, {
  3.953117376936823*^9, 3.9531173823360405`*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"cdbf7a85-9e45-0647-9785-b3f8debdbf04"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["a", "1"]},
     {
      RowBox[{
       RowBox[{"tO", " ", 
        SubscriptBox["a", "2"]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["tO", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["tO", "2"]}]], " ", 
        SubscriptBox["a", "2"]}], "-", 
       RowBox[{"tO", " ", 
        SubscriptBox["a", "3"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9531171320289726`*^9, 3.9531173831862392`*^9, 
  3.9625232265628643`*^9, 3.963456041242716*^9, 3.963463216202637*^9, 
  3.963483341158868*^9, 3.963800294880333*^9, 3.9638003892315454`*^9, 
  3.964407356773759*^9, 3.9663159528710155`*^9},
 CellLabel->
  "Out[225]//MatrixForm=",ExpressionUUID->"24ba0101-6ae3-413d-b107-\
f2348e2e1527"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DS", "[", 
   RowBox[{"bs", "[", 
    RowBox[{"tO", ",", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["tO", "2"]}]]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.953117424303318*^9, 3.9531174261243515`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"ea7f0faa-b083-db47-9be9-d33ff5905eb9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "tO", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["tO", "2"]}]]},
     {"0", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["tO", "2"]}]], 
      RowBox[{"-", "tO"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9531174218920097`*^9, 3.953117426467434*^9}, 
   3.9625232265699005`*^9, 3.9634560412701454`*^9, 3.963463216361435*^9, 
   3.9634833411668615`*^9, 3.9638002949388885`*^9, 3.9644073567994776`*^9, 
   3.966315952892887*^9},
 CellLabel->
  "Out[226]//MatrixForm=",ExpressionUUID->"d01609e3-5aae-4a79-b4e5-\
ed99872c4499"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Obj", "[", "tO_", "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0"},
       {"0", "tO", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["tO", "2"]}]]},
       {"0", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["tO", "2"]}]], 
        RowBox[{"-", "tO"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input",
 CellChangeTimes->{{3.9531173416970634`*^9, 3.9531173520961666`*^9}, {
  3.953117440509798*^9, 3.953117441376299*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"a42e6bf3-4518-c34c-a848-854ce69df80b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MZI", "Chapter",
 CellChangeTimes->{{3.8448436309671717`*^9, 3.844843660655164*^9}, 
   3.85308740684627*^9, {3.953117604021738*^9, 
   3.9531176043653526`*^9}},ExpressionUUID->"09af0663-be78-9343-94c6-\
4507d771eed1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", ">=", "\[Tau]", ">=", "0"}], " ", ",", 
     RowBox[{"1", ">=", "t", ">=", "0"}], " ", ",", 
     RowBox[{"1", ">=", "r", ">=", "0"}], ",", 
     RowBox[{"1", ">", 
      SubscriptBox["t", "1"], ">", "0"}], " ", ",", 
     RowBox[{"1", ">", 
      SubscriptBox["t", "2"], ">", "0"}], ",", 
     RowBox[{"1", ">", "R", ">", "0"}], ",", 
     RowBox[{"1", ">", "T", ">", "0"}], ",", 
     RowBox[{"1", ">", "R1", ">", "0"}], ",", 
     RowBox[{"1", ">", "T1", ">", "0"}], ",", 
     RowBox[{"1", ">", "R2", ">", "0"}], ",", 
     RowBox[{"1", ">", "T2", ">", "0"}], ",", 
     RowBox[{"1", ">", "r1", ">", "0"}], ",", 
     RowBox[{"1", ">", "r2", ">", "0"}], ",", 
     RowBox[{"\[Eta]1", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Eta]2", "\[Element]", "Reals"}], ",", 
     RowBox[{"G", "\[Element]", "Reals"}], ",", 
     RowBox[{"H", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Theta]", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[ScriptCapitalN]", "\[GreaterEqual]", "0"}], ",", 
     RowBox[{"\[Theta]1", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Theta]2", "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Nu]", "\[GreaterEqual]", "0"}], ",", 
     RowBox[{"\[Mu]", "\[GreaterEqual]", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHR1e90Ho2htHw9gzP0C0zasIFmEg3c5oyAqi73Xa
CoNoDk4PMP1v/wRZED3l3Qw5EK0gvzRwF5B+t48zBET/O2XayH4TSLt1tYBo
UdHcDhBd9NCvC0Qfs9t7/NrbN44nrC+dA9E8Ox/l6zm+dbxU+7YQRNs9+n12
hdNbx2/efBdB9K0HSX0LPN867vj7F0x/aFhu4+D11rF6fZ8tiDazmxULoiUE
JsSBaGUehQXTgTRTwHQwfcRu7vFd3m8d5aIenQfReVmMn/cD6f2ZU8D0vu1t
aoeA9LYcdnUQ/WVy7L7DQHrLvFIwfWRD4HLxkreOV5hOrwPRLgtvrH3Z+tYx
YTbvBhDtErno1l8gzVFlew9Em3kwxW1sf+t4x/QTmAYAUxu5lA==
  "],
 CellLabel->
  "In[228]:=",ExpressionUUID->"db1b6950-af52-d44e-93e2-d99012b1a644"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MZ", "[", 
    RowBox[{"r_", ",", "t_", ",", "\[CurlyPhi]_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BS", "[", 
     RowBox[{"r", ",", "t"}], "]"}], ".", 
    RowBox[{"Obj", "[", "\[Tau]", "]"}], ".", 
    RowBox[{"P", "[", 
     RowBox[{"\[CurlyPhi]", ",", "0"}], "]"}], ".", 
    RowBox[{"BS", "[", 
     RowBox[{"r", ",", "t"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9320170860676966`*^9, 3.932017210656431*^9}, {
   3.9320172420406933`*^9, 3.932017244096693*^9}, {3.932017305705938*^9, 
   3.9320173123363204`*^9}, {3.9320173597853727`*^9, 3.932017367897211*^9}, 
   3.9320174706819143`*^9, {3.953117639688263*^9, 3.953117707933731*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"f572c662-003d-af43-9333-4023e7ebb7dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MZinv", "[", 
    RowBox[{"r_", ",", "t_", ",", "\[CurlyPhi]_", ",", "\[Tau]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BS", "[", 
     RowBox[{"r", ",", "t"}], "]"}], ".", 
    RowBox[{"P", "[", 
     RowBox[{
      RowBox[{"-", "\[CurlyPhi]"}], ",", "0"}], "]"}], ".", 
    RowBox[{"Obj", "[", "\[Tau]", "]"}], ".", 
    RowBox[{"BS", "[", 
     RowBox[{"r", ",", "t"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.953117690458206*^9, 3.95311771995854*^9}, {
  3.9531177813185577`*^9, 3.953117785640196*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"b4b890db-7603-134e-a95a-2508fdd89866"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MZT", "=", 
   RowBox[{"MZ", "[", 
    RowBox[{
     SqrtBox["R"], ",", 
     SqrtBox["T"], ",", "\[CurlyPhi]", ",", "\[Tau]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9531178623366776`*^9, 3.9531179286954384`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"baed7346-dfc5-b64d-a39c-e37c73b7c323"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MZTinv", "=", 
   RowBox[{"MZinv", "[", 
    RowBox[{
     SqrtBox["R"], ",", 
     SqrtBox["T"], ",", "\[CurlyPhi]", ",", "\[Tau]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9531179373905754`*^9, 3.9531179446475677`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"33b2e67b-790e-cf43-9594-31574af65298"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GMZ", "[", 
    RowBox[{
    "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", "\[CurlyPhi]_", ",", 
     "\[Tau]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BS", "[", 
     RowBox[{"r2", ",", "t2"}], "]"}], ".", 
    RowBox[{"Obj", "[", "\[Tau]", "]"}], ".", 
    RowBox[{"P", "[", 
     RowBox[{"\[CurlyPhi]", ",", "0"}], "]"}], ".", 
    RowBox[{"BS", "[", 
     RowBox[{"r1", ",", "t1"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.962522848459202*^9, 3.9625228916490536`*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"db0fa99c-ca35-3647-a8c5-861f05f41516"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GMZinv", "[", 
    RowBox[{
    "r1_", ",", "t1_", ",", "r2_", ",", "t2_", ",", "\[CurlyPhi]_", ",", 
     "\[Tau]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"BS", "[", 
     RowBox[{"r1", ",", "t1"}], "]"}], ".", 
    RowBox[{"P", "[", 
     RowBox[{
      RowBox[{"-", "\[CurlyPhi]"}], ",", "0"}], "]"}], ".", 
    RowBox[{"Obj", "[", "\[Tau]", "]"}], ".", 
    RowBox[{"BS", "[", 
     RowBox[{"r2", ",", "t2"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.962522936449087*^9, 3.9625229610492783`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"088c8aec-9658-c546-88c1-6ee77979e4c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GMZT", "=", 
   RowBox[{"GMZ", "[", 
    RowBox[{
     SqrtBox["R1"], ",", 
     SqrtBox["T1"], ",", 
     SqrtBox["R2"], ",", 
     SqrtBox["T2"], ",", "\[CurlyPhi]", ",", "\[Tau]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9625230410013447`*^9, 3.962523120247675*^9}, 
   3.9625232841122303`*^9},
 CellLabel->
  "In[235]:=",ExpressionUUID->"de6bad6b-a9aa-6248-9df2-14445cc716fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GMZTinv", "=", 
   RowBox[{"GMZinv", "[", 
    RowBox[{
     SqrtBox["R1"], ",", 
     SqrtBox["T1"], ",", 
     SqrtBox["R2"], ",", 
     SqrtBox["T2"], ",", "\[CurlyPhi]", ",", "\[Tau]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.962523132747036*^9, 3.9625231499605846`*^9}, 
   3.962523287095516*^9},
 CellLabel->
  "In[236]:=",ExpressionUUID->"4e887d77-9bd8-ea41-bbbb-e63892ef43bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"MZT", ".", "ain"}], ")"}], "//", "MatrixForm", " "}]], "Input",
 CellChangeTimes->{{3.953118201117697*^9, 3.9531182263386345`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"d160f9e2-7630-604a-9cbb-c88b94437f52"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", "R"}], "+", 
          RowBox[{"T", " ", "\[Tau]"}]}], ")"}], " ", 
        SubscriptBox["a", "1"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R"], " ", 
           SqrtBox["T"]}], "-", 
          RowBox[{
           SqrtBox["R"], " ", 
           SqrtBox["T"], " ", "\[Tau]"}]}], ")"}], " ", 
        SubscriptBox["a", "2"]}], "+", 
       RowBox[{
        SqrtBox["T"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R"], " ", 
           SqrtBox["T"]}], "-", 
          RowBox[{
           SqrtBox["R"], " ", 
           SqrtBox["T"], " ", "\[Tau]"}]}], ")"}], " ", 
        SubscriptBox["a", "1"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", "T"}], "+", 
          RowBox[{"R", " ", "\[Tau]"}]}], ")"}], " ", 
        SubscriptBox["a", "2"]}], "-", 
       RowBox[{
        SqrtBox["R"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        SqrtBox["T"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "1"]}], "-", 
       RowBox[{
        SqrtBox["R"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "2"]}], "-", 
       RowBox[{"\[Tau]", " ", 
        SubscriptBox["a", "3"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9531182265940647`*^9, 3.9625232662321396`*^9, 
  3.963456041338488*^9, 3.963463216613377*^9, 3.9634833412406535`*^9, 
  3.96380029511279*^9, 3.9644073568850827`*^9, 3.966315953240997*^9},
 CellLabel->
  "Out[237]//MatrixForm=",ExpressionUUID->"e5c5af31-9476-4a8d-ae37-\
6b09f50fd588"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"MZT", ".", "ain"}], ")"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9531182340938797`*^9, 3.9531182523902855`*^9}},
 CellLabel->
  "In[238]:=",ExpressionUUID->"882994b2-1d3d-1f41-9e79-1975510d707f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
      SqrtBox["R"], " ", 
      SqrtBox["T"]}], "-", 
     RowBox[{
      SqrtBox["R"], " ", 
      SqrtBox["T"], " ", "\[Tau]"}]}], ")"}], " ", 
   SubscriptBox["a", "1"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", "T"}], "+", 
     RowBox[{"R", " ", "\[Tau]"}]}], ")"}], " ", 
   SubscriptBox["a", "2"]}], "-", 
  RowBox[{
   SqrtBox["R"], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["\[Tau]", "2"]}]], " ", 
   SubscriptBox["a", "3"]}]}]], "Output",
 CellChangeTimes->{{3.9531182424248104`*^9, 3.9531182527484455`*^9}, 
   3.9625232662411556`*^9, 3.963456041352462*^9, 3.9634632167398596`*^9, 
   3.963483341264275*^9, 3.9638002951885953`*^9, 3.964407356911358*^9, 
   3.9663159532980394`*^9},
 CellLabel->
  "Out[238]=",ExpressionUUID->"6f6dbd4c-c6a3-4bdc-9512-9ff849e3b4ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"GMZT", ".", "ain2"}], ")"}], "//", "MatrixForm", " "}]], "Input",
 CellChangeTimes->{{3.9625233325610867`*^9, 3.962523343647436*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"f8378790-fc89-a04e-87de-b1b1348a4951"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R1"], " ", 
           SqrtBox["R2"]}], "+", 
          RowBox[{
           SqrtBox["T1"], " ", 
           SqrtBox["T2"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Mu]"], "+", 
          SubscriptBox["a", "1"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R2"], " ", 
           SqrtBox["T1"]}], "-", 
          RowBox[{
           SqrtBox["R1"], " ", 
           SqrtBox["T2"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Nu]"], "+", 
          SubscriptBox["a", "2"]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["T2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R1"], " ", 
           SqrtBox["T2"]}], "-", 
          RowBox[{
           SqrtBox["R2"], " ", 
           SqrtBox["T1"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Mu]"], "+", 
          SubscriptBox["a", "1"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["T1"], " ", 
           SqrtBox["T2"]}], "+", 
          RowBox[{
           SqrtBox["R1"], " ", 
           SqrtBox["R2"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Nu]"], "+", 
          SubscriptBox["a", "2"]}], ")"}]}], "-", 
       RowBox[{
        SqrtBox["R2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        SqrtBox["T1"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Mu]"], "+", 
          SubscriptBox["a", "1"]}], ")"}]}], "-", 
       RowBox[{
        SqrtBox["R1"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Nu]"], "+", 
          SubscriptBox["a", "2"]}], ")"}]}], "-", 
       RowBox[{"\[Tau]", " ", 
        SubscriptBox["a", "3"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9625233353885555`*^9, 3.962523344556999*^9}, 
   3.963456041372341*^9, 3.9634632168376675`*^9, 3.963483341273343*^9, 
   3.9638002952793484`*^9, 3.9644073569347553`*^9, 3.966315953358982*^9},
 CellLabel->
  "Out[239]//MatrixForm=",ExpressionUUID->"27d80889-f686-411d-8119-\
a04785df541a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"GMZT", ".", "alpha"}], ")"}], "//", "MatrixForm", " "}]], "Input",
 CellChangeTimes->{{3.96252340365588*^9, 3.962523405455141*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"12223896-5f9d-0c47-8bbe-9003bd6567e3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SqrtBox["\[Nu]"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R2"], " ", 
           SqrtBox["T1"]}], "-", 
          RowBox[{
           SqrtBox["R1"], " ", 
           SqrtBox["T2"], " ", "\[Tau]"}]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["\[Mu]"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R1"], " ", 
           SqrtBox["R2"]}], "+", 
          RowBox[{
           SqrtBox["T1"], " ", 
           SqrtBox["T2"], " ", "\[Tau]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SqrtBox["\[Nu]"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["T1"], " ", 
           SqrtBox["T2"]}], "+", 
          RowBox[{
           SqrtBox["R1"], " ", 
           SqrtBox["R2"], " ", "\[Tau]"}]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["\[Mu]"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R1"], " ", 
           SqrtBox["T2"]}], "-", 
          RowBox[{
           SqrtBox["R2"], " ", 
           SqrtBox["T1"], " ", "\[Tau]"}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        SqrtBox["T1"], " ", 
        SqrtBox["\[Mu]"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]]}], "-", 
       RowBox[{
        SqrtBox["R1"], " ", 
        SqrtBox["\[Nu]"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9625234062687607`*^9, 3.963456041391553*^9, 
  3.963463217059939*^9, 3.9634833412982674`*^9, 3.963800295350864*^9, 
  3.96440735696721*^9, 3.9663159534331245`*^9},
 CellLabel->
  "Out[240]//MatrixForm=",ExpressionUUID->"1973eb18-e393-4ddf-b6ca-\
7a6f145586a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"GMZT", ".", "ain2"}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9625679251002045`*^9, 3.9625679274568443`*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"ccdabe24-b502-8640-927b-86d0badf577a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R1"], " ", 
           SqrtBox["R2"]}], "+", 
          RowBox[{
           SqrtBox["T1"], " ", 
           SqrtBox["T2"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Mu]"], "+", 
          SubscriptBox["a", "1"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R2"], " ", 
           SqrtBox["T1"]}], "-", 
          RowBox[{
           SqrtBox["R1"], " ", 
           SqrtBox["T2"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Nu]"], "+", 
          SubscriptBox["a", "2"]}], ")"}]}], "+", 
       RowBox[{
        SqrtBox["T2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["R1"], " ", 
           SqrtBox["T2"]}], "-", 
          RowBox[{
           SqrtBox["R2"], " ", 
           SqrtBox["T1"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Mu]"], "+", 
          SubscriptBox["a", "1"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
           SqrtBox["T1"], " ", 
           SqrtBox["T2"]}], "+", 
          RowBox[{
           SqrtBox["R1"], " ", 
           SqrtBox["R2"], " ", "\[Tau]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Nu]"], "+", 
          SubscriptBox["a", "2"]}], ")"}]}], "-", 
       RowBox[{
        SqrtBox["R2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        SubscriptBox["a", "3"]}]}]},
     {
      RowBox[{
       RowBox[{
        SqrtBox["T1"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Mu]"], "+", 
          SubscriptBox["a", "1"]}], ")"}]}], "-", 
       RowBox[{
        SqrtBox["R1"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Tau]", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[Nu]"], "+", 
          SubscriptBox["a", "2"]}], ")"}]}], "-", 
       RowBox[{"\[Tau]", " ", 
        SubscriptBox["a", "3"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.9625679279205723`*^9, 3.963456041406065*^9, 
  3.9634632172396164`*^9, 3.9634833413062277`*^9, 3.9638002954407673`*^9, 
  3.964407357006414*^9, 3.9663159534978285`*^9},
 CellLabel->
  "Out[241]//MatrixForm=",ExpressionUUID->"feb52988-7ae0-4091-a50f-\
b1dca5ae93b6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["b", "j_"], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"GMZT", ".", "ain2"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9531181832745247`*^9, 3.9531181931357822`*^9}, {
  3.953118258814804*^9, 3.953118265525852*^9}, {3.962523479295273*^9, 
  3.962523483438978*^9}},
 CellLabel->
  "In[242]:=",ExpressionUUID->"ff88eb87-1515-1044-a011-0e7d0fe12519"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["A", "j_"], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"GMZTinv", ".", "ain2"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9531805055594654`*^9, 3.953180525470207*^9}, {
  3.9625234901676884`*^9, 3.9625235134391193`*^9}},
 CellLabel->
  "In[243]:=",ExpressionUUID->"423562d1-8fd4-bb4c-bb22-1640a6327f38"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["beta", "j_"], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"GMZT", ".", "alpha"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9625235325132065`*^9, 3.9625235606785603`*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"e9deda4f-6872-9d49-81b6-3be400989180"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    SubscriptBox["b", "j_"], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"MZT", ".", "ain"}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9531181832745247`*^9, 3.9531181931357822`*^9}, {
  3.953118258814804*^9, 3.953118265525852*^9}},
 CellLabel->
  "In[245]:=",ExpressionUUID->"3325963c-e4bb-834a-b06e-85f53c534815"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    SubscriptBox["A", "j_"], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"MZTinv", ".", "ain"}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9531805055594654`*^9, 3.953180525470207*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"32b72046-8361-5245-8f24-5d159ef69501"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       SubscriptBox["beta", "1"], ")"}], "\[Conjugate]"}], 
     RowBox[{"(", 
      SubscriptBox["beta", "1"], ")"}]}], "//", "Refine"}], "//", 
   "Simplify"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.9625672659925957`*^9, 3.962567270590559*^9}, {
   3.9625673422149315`*^9, 3.9625673927814255`*^9}, 3.96256743939781*^9},
 CellLabel->
  "In[247]:=",ExpressionUUID->"04b8ff5c-4a04-e641-9639-93bdc7598452"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{"R1", " ", "R2", " ", "\[Mu]"}]], "+", 
       SqrtBox[
        RowBox[{"R2", " ", "T1", " ", "\[Nu]"}]]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{"T1", " ", "T2", " ", "\[Mu]"}]], "-", 
       RowBox[{"1.`", " ", 
        SqrtBox[
         RowBox[{"R1", " ", "T2", " ", "\[Nu]"}]]}]}], ")"}], " ", 
     "\[Tau]"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"R1", " ", "R2", " ", "\[Mu]"}]], "+", 
        SqrtBox[
         RowBox[{"R2", " ", "T1", " ", "\[Nu]"}]]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"T1", " ", "T2", " ", "\[Mu]"}]], "-", 
        RowBox[{"1.`", " ", 
         SqrtBox[
          RowBox[{"R1", " ", "T2", " ", "\[Nu]"}]]}]}], ")"}], " ", 
      "\[Tau]"}]}], ")"}], "*"]}]], "Output",
 CellChangeTimes->{3.9625674416422825`*^9, 3.9634560420322266`*^9, 
  3.9634632189919844`*^9, 3.96348334178494*^9, 3.9638002961085587`*^9, 
  3.9638004094342537`*^9, 3.9644073575321674`*^9, 3.9663159549255743`*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"f14c5466-a930-4492-b1d4-b175209241f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[" Setting up quantum toolkit", "Subchapter",
 CellChangeTimes->{{3.8448445350072374`*^9, 3.8448445771512613`*^9}, {
  3.8450281668102765`*^9, 
  3.8450281813301687`*^9}},ExpressionUUID->"5dbefad7-cf1d-0c4c-a0cf-\
d28dc1fd4d16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Quantum`Notation`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetQuantumAliases", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449312233118315`*^9, 3.8449312233118315`*^9}, 
   3.8450194015845027`*^9},
 CellLabel->
  "In[248]:=",ExpressionUUID->"f39d6875-f450-eb46-af6a-1eb6d8ff3965"],

Cell[CellGroupData[{

Cell["Defining operators", "Subsubsection",
 CellChangeTimes->{{3.8452624163391366`*^9, 3.8452624219695845`*^9}, {
  3.926581770684287*^9, 
  3.9265817745080013`*^9}},ExpressionUUID->"ded2464f-b4de-a843-9f63-\
1c8c6bda389d"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "0"}], ",", 
   RowBox[{"k", "<", 
    RowBox[{"NumModes", "+", "1"}]}], ",", 
   RowBox[{"k", "++"}], ",", 
   RowBox[{"DefineOperatorOnKets", "[", 
    RowBox[{
     SubscriptBox["a", "k"], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          SubscriptBox["w_", 
           OverscriptBox[
            SubscriptBox["n", "k"], "^"]],
          Quantum`Notation`zz080KetArgs,
          BaseStyle->{ShowSyntaxStyles -> True},
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        BaseStyle->{ShowSyntaxStyles -> False},
        Editable->False,
        Selectable->False], "\[RuleDelayed]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         SqrtBox["w"], 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["w", 
              OverscriptBox[
               SubscriptBox["n", "k"], "^"]]}],
            Quantum`Notation`zz080KetArgs,
            BaseStyle->{ShowSyntaxStyles -> True},
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          BaseStyle->{ShowSyntaxStyles -> False},
          Editable->False,
          Selectable->False], 
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             SubscriptBox["w", 
              OverscriptBox[
               SubscriptBox["n", "k"], "^"]],
             Quantum`Notation`zz080BraArgs,
             BaseStyle->{ShowSyntaxStyles -> True},
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           BaseStyle->{ShowSyntaxStyles -> False},
           Editable->False,
           Selectable->False], "\[CenterDot]", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             SubscriptBox["w", 
              OverscriptBox[
               SubscriptBox["n", "k"], "^"]],
             Quantum`Notation`zz080KetArgs,
             BaseStyle->{ShowSyntaxStyles -> True},
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           BaseStyle->{ShowSyntaxStyles -> False},
           Editable->False,
           Selectable->False]}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8558197124418726`*^9, 3.855819834813981*^9}, {
   3.8594593799920406`*^9, 3.8594594691648135`*^9}, 3.859459571677309*^9, 
   3.8594597683184347`*^9, 3.926491833713592*^9},
 CellLabel->
  "In[250]:=",ExpressionUUID->"4e5ecc33-6c31-9845-9da0-2851497e80bc"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "0"}], ",", 
   RowBox[{"k", "<", 
    RowBox[{"NumModes", "+", "1"}]}], ",", 
   RowBox[{"k", "++"}], ",", 
   RowBox[{"DefineOperatorOnKets", "[", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["a", "k"], "\[Dagger]"], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"\[VerticalSeparator]", 
         TagBox[
          SubscriptBox["w_", 
           OverscriptBox[
            SubscriptBox["n", "k"], "^"]],
          Quantum`Notation`zz080KetArgs,
          BaseStyle->{ShowSyntaxStyles -> True},
          Editable->True,
          Selectable->True], "\[RightAngleBracket]"}],
        Quantum`Notation`zz080Ket,
        BaseStyle->{ShowSyntaxStyles -> False},
        Editable->False,
        Selectable->False], "\[RuleDelayed]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         SqrtBox[
          RowBox[{"w", "+", "1"}]], 
         TagBox[
          RowBox[{"\[VerticalSeparator]", 
           TagBox[
            RowBox[{"1", "+", 
             SubscriptBox["w", 
              OverscriptBox[
               SubscriptBox["n", "k"], "^"]]}],
            Quantum`Notation`zz080KetArgs,
            BaseStyle->{ShowSyntaxStyles -> True},
            Editable->True,
            Selectable->True], "\[RightAngleBracket]"}],
          Quantum`Notation`zz080Ket,
          BaseStyle->{ShowSyntaxStyles -> False},
          Editable->False,
          Selectable->False], 
         RowBox[{
          TagBox[
           RowBox[{"\[LeftAngleBracket]", 
            TagBox[
             SubscriptBox["w", 
              OverscriptBox[
               SubscriptBox["n", "k"], "^"]],
             Quantum`Notation`zz080BraArgs,
             BaseStyle->{ShowSyntaxStyles -> True},
             Editable->True,
             Selectable->True], "\[VerticalSeparator]"}],
           Quantum`Notation`zz080Bra,
           BaseStyle->{ShowSyntaxStyles -> False},
           Editable->False,
           Selectable->False], "\[CenterDot]", 
          TagBox[
           RowBox[{"\[VerticalSeparator]", 
            TagBox[
             SubscriptBox["w", 
              OverscriptBox[
               SubscriptBox["n", "k"], "^"]],
             Quantum`Notation`zz080KetArgs,
             BaseStyle->{ShowSyntaxStyles -> True},
             Editable->True,
             Selectable->True], "\[RightAngleBracket]"}],
           Quantum`Notation`zz080Ket,
           BaseStyle->{ShowSyntaxStyles -> False},
           Editable->False,
           Selectable->False]}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8558199687322526`*^9, 3.8558199905143843`*^9}, 
   3.85945948770129*^9, {3.8594595294933476`*^9, 3.8594595765488358`*^9}, 
   3.9264918357703953`*^9},
 CellLabel->
  "In[251]:=",ExpressionUUID->"8916f029-9074-f545-9d94-9cbe00efd7b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Defining states", "Subsubsection",
 CellChangeTimes->{{3.8452624163391366`*^9, 3.8452624219695845`*^9}, {
  3.926581770684287*^9, 3.9265817745080013`*^9}, {3.9314226406803293`*^9, 
  3.931422641528065*^9}},ExpressionUUID->"d66ef25e-fd3d-414b-a487-\
10c669d188d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{"\[VerticalSeparator]", 
     TagBox["vac",
      Quantum`Notation`zz080KetArgs,
      BaseStyle->{ShowSyntaxStyles -> True},
      Editable->True,
      Selectable->True], "\[RightAngleBracket]"}],
    Quantum`Notation`zz080Ket,
    BaseStyle->{ShowSyntaxStyles -> False},
    Editable->False,
    Selectable->False], "=", 
   TagBox[
    RowBox[{
     UnderoverscriptBox["\[CircleTimes]", 
      TagBox[
       RowBox[{"q", "=", "1"}],
       Quantum`Notation`zz020TPNotationini,
       Editable->True,
       Selectable->True], 
      TagBox["NumModes",
       Quantum`Notation`zz020TPNotationend,
       Editable->True,
       Selectable->True]], 
     TagBox[
      TagBox[
       RowBox[{"\[VerticalSeparator]", 
        TagBox[
         SubscriptBox["0", 
          OverscriptBox[
           SubscriptBox["n", "q"], "^"]],
         Quantum`Notation`zz080KetArgs,
         BaseStyle->{ShowSyntaxStyles -> True},
         Editable->True,
         Selectable->True], "\[RightAngleBracket]"}],
       Quantum`Notation`zz080Ket,
       BaseStyle->{ShowSyntaxStyles -> False},
       Editable->False,
       Selectable->False],
      Quantum`Notation`zz020TPNotationdat,
      Editable->True,
      Selectable->True]}],
    Quantum`Notation`zz020TPNotation,
    Editable->False,
    Selectable->False]}], ";"}]], "Input",
 CellChangeTimes->{
  3.8686055489573703`*^9, {3.8686055941206436`*^9, 3.868605617804659*^9}, {
   3.86885850263945*^9, 3.868858509519429*^9}, {3.870332533819112*^9, 
   3.8703325356273007`*^9}, 3.926492237035503*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"e143077f-de5a-f84d-b799-f0e95ad5d7c0"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"\[VerticalSeparator]", 
   TagBox["vac",
    Quantum`Notation`zz080KetArgs,
    BaseStyle->{ShowSyntaxStyles -> True},
    Editable->True,
    Selectable->True], "\[RightAngleBracket]"}],
  Quantum`Notation`zz080Ket,
  BaseStyle->{ShowSyntaxStyles -> False},
  Editable->False,
  Selectable->False]], "Input",
 CellLabel->
  "In[253]:=",ExpressionUUID->"61447260-397c-4e4e-b3cf-13a378237cff"],

Cell[BoxData[
 TagBox[
  RowBox[{"\[VerticalSeparator]", 
   TagBox[
    RowBox[{
     SubscriptBox["0", 
      OverscriptBox[
       SubscriptBox["n", "1"], "^"]], ",", 
     SubscriptBox["0", 
      OverscriptBox[
       SubscriptBox["n", "2"], "^"]], ",", 
     SubscriptBox["0", 
      OverscriptBox[
       SubscriptBox["n", "3"], "^"]]}],
    Quantum`Notation`zz080KetArgs,
    BaseStyle->{ShowSyntaxStyles -> True},
    Editable->True,
    Selectable->True], "\[RightAngleBracket]"}],
  Quantum`Notation`zz080Ket,
  BaseStyle->{ShowSyntaxStyles -> False},
  Editable->False,
  Selectable->False]], "Output",
 CellChangeTimes->{3.9531824686391144`*^9, 3.9634560441057205`*^9, 
  3.9634632198624907`*^9, 3.963483342449192*^9, 3.963800296493232*^9, 
  3.963800491876676*^9, 3.9644073593083086`*^9, 3.9663159558038435`*^9},
 CellLabel->
  "Out[253]=",ExpressionUUID->"b77f923b-f9f9-4311-9e0e-af4f862a5a32"]
}, Open  ]],

Cell["Photon number operator", "Text",
 CellChangeTimes->{{3.962587548447878*^9, 
  3.962587559495861*^9}},ExpressionUUID->"de156ce5-2907-d043-b287-\
ad8c64e968e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Nb", "j_"], ":=", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["b", "j"], "\[Dagger]"], "\[CenterDot]", 
    SubscriptBox["b", "j"]}]}], ";"}]], "Input",
 CellLabel->
  "In[254]:=",ExpressionUUID->"1ea9932e-6dbf-8c48-aab4-04ab64c08830"]
}, Open  ]],

Cell[CellGroupData[{

Cell["some auxiliary functions ", "Subsubsection",
 CellChangeTimes->{{3.852790603311352*^9, 
  3.8527906240711603`*^9}},ExpressionUUID->"ec75e505-afdd-154d-aba4-\
881f5ad52190"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"MyRe", "[", "z_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Refine", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"ComplexExpand", "[", 
          RowBox[{"Refine", "[", 
           RowBox[{"z", ",", 
            RowBox[{"Assumptions", "\[Rule]", 
             RowBox[{"N\[Alpha]", ">", "0"}]}]}], "]"}], "]"}], " ", "]"}], 
        ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Theta]1", ",", "\[Theta]2", ",", "\[Theta]\[Alpha]", ",", "G",
               ",", "H"}], "}"}], " ", "\[Element]", " ", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              SubscriptBox["t", "1"], ",", 
              SubscriptBox["t", "2"], ",", "N\[Alpha]"}], "}"}], ">", "0"}]}],
           "}"}]}]}], "]"}], "//", "FullSimplify"}], "//", "Rationalize"}]}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{3.850728124904607*^9, 3.9264931240789495`*^9},
 CellLabel->
  "In[255]:=",ExpressionUUID->"bed37845-f1c7-ee49-9869-53101e069eec"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"MyRefine", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "G", ",", "H", ",", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox[
               SubscriptBox["t", "1"], "2"]}]], ",", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox[
               SubscriptBox["t", "2"], "2"]}]]}], "}"}], "\[Element]", 
          "Reals"}], "&&", 
         RowBox[{
          RowBox[{"1", "-", 
           SuperscriptBox[
            SubscriptBox["t", "1"], "2"]}], "\[GreaterEqual]", "0", "<", 
          "1"}], "&&", 
         RowBox[{
          RowBox[{"1", "-", 
           SuperscriptBox[
            SubscriptBox["t", "2"], "2"]}], "\[GreaterEqual]", "0"}], " ", "&&", 
         RowBox[{"N\[Alpha]", ">", "0"}]}], ",", 
        RowBox[{"Refine", "[", 
         RowBox[{"FullSimplify", "[", 
          RowBox[{"ComplexExpand", "[", "x", "]"}], "]"}], "]"}]}], "]"}], "//",
       "FullSimplify"}], "//", "Rationalize"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.8526328675088263`*^9, 3.8526328708068585`*^9}, 
   3.9264931202955008`*^9},
 CellLabel->
  "In[256]:=",ExpressionUUID->"cbea875d-77f3-4a44-9a9a-77eaa597154c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Compare", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TrueQ", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", "x", ")"}], "-", 
       RowBox[{"(", "y", ")"}]}], "]"}], "\[Equal]", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.852723843771115*^9, 3.8527238726616254`*^9}, {
  3.8527240934646797`*^9, 3.8527241047262726`*^9}, {3.9264930024763584`*^9, 
  3.9264930046842117`*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"944a7a6f-ffad-8148-b4b6-1b653d330002"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify", "[", "O_", "]"}], ":=", 
   RowBox[{"Rationalize", "[", 
    RowBox[{"FullSimplify", "[", "O", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9314337747825084`*^9, 3.9314338010825014`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"4c7cd41c-ae78-5d4d-acab-8496241ea7c3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"abs2", "[", "x_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Rationalize", "[", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", "G", ",", "H", ",", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox[
                 SubscriptBox["t", "1"], "2"]}]], ",", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox[
                 SubscriptBox["t", "2"], "2"]}]]}], "}"}], "\[Element]", 
            "Reals"}], "&&", 
           RowBox[{
            RowBox[{"1", "-", 
             SuperscriptBox[
              SubscriptBox["t", "1"], "2"]}], "\[GreaterEqual]", "0", "<", 
            "1"}], "&&", 
           RowBox[{
            RowBox[{"1", "-", 
             SuperscriptBox[
              SubscriptBox["t", "2"], "2"]}], "\[GreaterEqual]", "0"}], " ", "&&", 
           RowBox[{"N\[Alpha]", ">", "0"}]}], ",", 
          RowBox[{"Refine", "[", 
           RowBox[{"FullSimplify", "[", 
            RowBox[{"ComplexExpand", "[", 
             RowBox[{
              SuperscriptBox["x", "\[Conjugate]"], "x"}], "]"}], "]"}], 
           "]"}]}], "]"}], "]"}], "]"}], "]"}], "//", "Simplify"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.8465774348635054`*^9, {3.8466625551809235`*^9, 3.846662557594179*^9}, {
   3.8467453535035186`*^9, 3.84674539908304*^9}, {3.8467454387556376`*^9, 
   3.846745469937039*^9}, {3.846745509270256*^9, 3.8467455310719385`*^9}, {
   3.846838524421089*^9, 3.8468385553875513`*^9}, {3.8470977565482283`*^9, 
   3.847097774913289*^9}, {3.8501149421322365`*^9, 3.8501149640331182`*^9}, {
   3.850115080520401*^9, 3.850115151016296*^9}, {3.8501151858902307`*^9, 
   3.850115277214801*^9}, 3.8526217032865343`*^9, 3.9264931160956535`*^9},
 CellLabel->
  "In[259]:=",ExpressionUUID->"3185140d-50fe-604b-960a-3d368bbbd00e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expectation values, variance and sensitivity", "Subsubsection",
 CellChangeTimes->{{3.8452624163391366`*^9, 3.8452624219695845`*^9}, {
  3.926581770684287*^9, 3.9265817745080013`*^9}, {3.9314226406803293`*^9, 
  3.9314227040156736`*^9}, {3.9456661754451237`*^9, 3.9456661785727587`*^9}, {
  3.9625681750496483`*^9, 
  3.9625681806026707`*^9}},ExpressionUUID->"0415d5f2-affa-fc4f-8cd7-\
c1fb424b6b8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VEV", "[", "O_", "]"}], ":=", 
   RowBox[{
    TagBox[
     RowBox[{"\[LeftAngleBracket]", 
      TagBox["vac",
       Quantum`Notation`zz080BraArgs,
       BaseStyle->{ShowSyntaxStyles -> True},
       Editable->True,
       Selectable->True], "\[VerticalSeparator]"}],
     Quantum`Notation`zz080Bra,
     BaseStyle->{ShowSyntaxStyles -> False},
     Editable->False,
     Selectable->False], "\[CenterDot]", 
    RowBox[{"Refine", "[", "O", "]"}], "\[CenterDot]", 
    TagBox[
     RowBox[{"\[VerticalSeparator]", 
      TagBox["vac",
       Quantum`Notation`zz080KetArgs,
       BaseStyle->{ShowSyntaxStyles -> True},
       Editable->True,
       Selectable->True], "\[RightAngleBracket]"}],
     Quantum`Notation`zz080Ket,
     BaseStyle->{ShowSyntaxStyles -> False},
     Editable->False,
     Selectable->False]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.962567682825096*^9, 3.9625677340459976`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"7600702a-66eb-1848-831a-06ed72795091"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Var", "[", "O_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"VEV", "[", 
      RowBox[{"O", "\[CenterDot]", "O"}], "]"}], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"VEV", "[", "O", "]"}], ")"}], "2"]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9625677569175453`*^9, 3.962567780309637*^9}, {
  3.962568700266447*^9, 3.962568702626316*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"909d8956-89ff-9c4e-95a0-d212a630082e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Cov", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"VEV", "[", 
      RowBox[{"A", "\[CenterDot]", "B"}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VEV", "[", "A", "]"}], 
       RowBox[{"VEV", "[", "B", "]"}]}], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9625685837320995`*^9, 3.9625686302985287`*^9}, {
  3.962568680970148*^9, 3.962568683338686*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"7d6e6b66-2005-734e-9e84-832c748c9bba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sens\[CurlyPhi]", "[", 
    RowBox[{"O_", ",", "\[CurlyPhi]_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"Var", "[", "O", "]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"VEV", "[", "O", "]"}], ",", "\[CurlyPhi]"}], "]"}], ")"}], 
     "2"]]}], ";"}]], "Input",
 CellChangeTimes->{{3.962568132605402*^9, 3.9625681543634224`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"f0ad9b20-d71e-744c-a888-3a355ab30272"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sensitivity evaluation", "Subsubsection",
 CellChangeTimes->{{3.8452624163391366`*^9, 3.8452624219695845`*^9}, {
  3.926581770684287*^9, 3.9265817745080013`*^9}, {3.9314226406803293`*^9, 
  3.9314227040156736`*^9}, {3.9625868635300865`*^9, 
  3.962586865841694*^9}},ExpressionUUID->"5e78bbcc-dbe4-cc4a-b0ee-\
950a9412c5f7"],

Cell["\<\
First, let us evaluate the variance. For a coherent state, the covariance \
should vanish, so we have\
\>", "Text",
 CellChangeTimes->{{3.9625868961383553`*^9, 
  3.9625869418978004`*^9}},ExpressionUUID->"3b4171a8-a27f-3242-9bf2-\
14ebf5638efc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VEV", "[", 
    SubscriptBox["Nb", "1"], "]"}], "+", 
   RowBox[{"VEV", "[", 
    SubscriptBox["Nb", "2"], "]"}]}], "//", "MySimplify"}]], "Input",
 CellChangeTimes->{{3.9625690256245556`*^9, 3.9625690474618587`*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"06e9b526-a8e0-854a-963b-8c34620f5504"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"R2", "+", "T2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{"R1", " ", "T1", " ", "\[Mu]", " ", "\[Nu]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[Tau]", "2"]}], ")"}]}], "+", 
      RowBox[{"T1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Nu]"}], "-", 
         RowBox[{"\[Mu]", " ", 
          SuperscriptBox["\[Tau]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"R1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Mu]"}], "-", 
         RowBox[{"\[Nu]", " ", 
          SuperscriptBox["\[Tau]", "2"]}]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.962569037957409*^9, 3.962569048086014*^9}, 
   3.963456047873831*^9, 3.9634632228152046`*^9, 3.963483343383273*^9, 
   3.96380029812214*^9, 3.9644073602888775`*^9, 3.966315957848693*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"22ad005b-1695-44d4-94a3-9d92e63e7645"]
}, Open  ]],

Cell["\<\
This is the same as the sum of the photon numbers in both ports\
\>", "Text",
 CellChangeTimes->{{3.9625874424719353`*^9, 
  3.962587467863056*^9}},ExpressionUUID->"cdee7aca-3a19-3e45-9700-\
a81ed62fd3d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       SubscriptBox["beta", "1"], ")"}], "\[Conjugate]"}], 
     RowBox[{"(", 
      SubscriptBox["beta", "1"], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       SubscriptBox["beta", "2"], ")"}], "\[Conjugate]"}], 
     RowBox[{"(", 
      SubscriptBox["beta", "2"], ")"}]}]}], "//", "Refine"}], "//", 
  "MySimplify"}]], "Input",
 CellChangeTimes->{3.9625875018252296`*^9},
 CellLabel->
  "In[265]:=",ExpressionUUID->"c2fb70dc-147c-cd49-8714-fa25d3d32d37"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"R1", " ", "T2", " ", "\[Mu]"}]], "+", 
        SqrtBox[
         RowBox[{"T1", " ", "T2", " ", "\[Nu]"}]]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"R2", " ", "T1", " ", "\[Mu]"}]]}], "+", 
        SqrtBox[
         RowBox[{"R1", " ", "R2", " ", "\[Nu]"}]]}], ")"}], " ", "\[Tau]"}]}],
     ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{"R1", " ", "T2", " ", "\[Mu]"}]], "+", 
         SqrtBox[
          RowBox[{"T1", " ", "T2", " ", "\[Nu]"}]]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           RowBox[{"R2", " ", "T1", " ", "\[Mu]"}]]}], "+", 
         SqrtBox[
          RowBox[{"R1", " ", "R2", " ", "\[Nu]"}]]}], ")"}], " ", 
       "\[Tau]"}]}], ")"}], "*"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"R1", " ", "R2", " ", "\[Mu]"}]], "+", 
        SqrtBox[
         RowBox[{"R2", " ", "T1", " ", "\[Nu]"}]]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"T1", " ", "T2", " ", "\[Mu]"}]], "-", 
        SqrtBox[
         RowBox[{"R1", " ", "T2", " ", "\[Nu]"}]]}], ")"}], " ", "\[Tau]"}]}],
     ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{"R1", " ", "R2", " ", "\[Mu]"}]], "+", 
         SqrtBox[
          RowBox[{"R2", " ", "T1", " ", "\[Nu]"}]]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          RowBox[{"T1", " ", "T2", " ", "\[Mu]"}]], "-", 
         SqrtBox[
          RowBox[{"R1", " ", "T2", " ", "\[Nu]"}]]}], ")"}], " ", 
       "\[Tau]"}]}], ")"}], "*"]}]}]], "Output",
 CellChangeTimes->{3.962587503122164*^9, 3.963456050449765*^9, 
  3.963463227731062*^9, 3.963483344701825*^9, 3.9638003002443104`*^9, 
  3.9644073616393437`*^9, 3.966315961511054*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"ff62e6fe-387e-44f7-9b56-2fc19279231a"]
}, Open  ]],

Cell["Next, we will show that the covariance vanishes", "Text",
 CellChangeTimes->{{3.9625869483578835`*^9, 3.962586958323097*^9}, {
  3.962587474304142*^9, 
  3.962587489590912*^9}},ExpressionUUID->"94252309-bb53-334d-90d4-\
2bd47d9187f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Cov", "[", 
   RowBox[{
    SubscriptBox["Nb", "1"], ",", 
    SubscriptBox["Nb", "2"]}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.962568655569748*^9, 3.962568672422348*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"831c72d9-aeee-0742-b0b8-7196f941e37f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox["\[Tau]", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R1", "+", "T1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"R1", " ", "R2", " ", "T1", " ", 
           SuperscriptBox["T2", "3"]}]]}], " ", "\[Mu]"}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"R1", " ", "R2", " ", "T1", " ", 
          SuperscriptBox["T2", "3"]}]], " ", "\[Nu]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"R1", "-", "T1"}], ")"}], " ", 
        SqrtBox[
         RowBox[{"R2", " ", 
          SuperscriptBox["T2", "3"], " ", "\[Mu]", " ", "\[Nu]"}]]}]}], ")"}],
      " ", "\[Tau]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{"R1", " ", 
          SuperscriptBox["R2", "3"], " ", "T1", " ", "T2"}]], " ", "\[Mu]"}], 
       "-", 
       RowBox[{
        SqrtBox[
         RowBox[{"R1", " ", 
          SuperscriptBox["R2", "3"], " ", "T1", " ", "T2"}]], " ", "\[Nu]"}], 
       "+", 
       RowBox[{
        SuperscriptBox["R1", "2"], " ", "R2", " ", 
        SqrtBox[
         RowBox[{"R2", " ", "T2", " ", "\[Mu]", " ", "\[Nu]"}]]}], "+", 
       RowBox[{"T1", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["R2", "3"], " ", "T2", " ", "\[Mu]", " ", 
          "\[Nu]"}]]}], "-", 
       RowBox[{"R2", " ", "T1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", "\[Mu]"}], 
          "-", 
          RowBox[{
           SqrtBox[
            RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", "\[Nu]"}], 
          "+", 
          RowBox[{"T1", " ", 
           SqrtBox[
            RowBox[{"R2", " ", "T2", " ", "\[Mu]", " ", "\[Nu]"}]]}]}], 
         ")"}]}], "-", 
       RowBox[{"R1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"R2", " ", 
           SqrtBox[
            RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", 
           RowBox[{"(", 
            RowBox[{"\[Mu]", "-", "\[Nu]"}], ")"}]}], "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["R2", "3"], " ", "T2", " ", "\[Mu]", " ", 
            "\[Nu]"}]]}], ")"}]}]}], ")"}], " ", "\[Tau]"}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", "R2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R1", "+", "T1"}], ")"}], " ", "T2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"R1", " ", "T1", " ", "\[Mu]", " ", "\[Nu]"}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[Tau]", "2"]}], ")"}]}], "+", 
       RowBox[{"T1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "-", 
          RowBox[{"\[Mu]", " ", 
           SuperscriptBox["\[Tau]", "2"]}]}], ")"}]}], "+", 
       RowBox[{"R1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Mu]", "-", 
          RowBox[{"\[Nu]", " ", 
           SuperscriptBox["\[Tau]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.963456090379013*^9, 3.9634632635886745`*^9, 
  3.963483354444873*^9, 3.963800315142932*^9, 3.964407371393281*^9, 
  3.9663159819733744`*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"81c90cdd-7d57-4a57-8c22-ed51427b120b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "R1", "+", "T1"}], ")"}], " ", 
    SqrtBox[
     RowBox[{"R2", " ", "T2"}]], " ", "\[ScriptCapitalN]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
       SqrtBox[
        RowBox[{"R1", " ", "T2"}]]}], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{"R2", " ", "T1"}]], " ", "\[Tau]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{"R1", " ", "R2"}]], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], " ", 
       SqrtBox[
        RowBox[{"T1", " ", "T2"}]], " ", "\[Tau]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[Tau]", "2"]}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T1", "->", 
      RowBox[{"1", "-", "R1"}]}], ",", 
     RowBox[{"T2", "->", 
      RowBox[{"1", "-", "R2"}]}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.962586276307457*^9, 3.962586278629637*^9}, 
   3.962586310142809*^9},
 CellLabel->
  "In[267]:=",ExpressionUUID->"5b788661-7999-dc43-ae9e-de11c0db582a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.9625863123943634`*^9, 3.9634632638125997`*^9, 
  3.9634833544748445`*^9, 3.96380031516924*^9, 3.9644073714358606`*^9, 
  3.9663159820354404`*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"1287db81-bec3-404b-8114-39a399369ca3"]
}, Open  ]],

Cell[TextData[{
 "The variance of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "1"], "-", 
    SubscriptBox["N", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d6ddc67c-957c-4543-9bbe-47525c22be9b"],
 " is the sum of variances of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c32dd97c-42ea-ee42-bf2e-b0f117fc8e4c"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b81af26d-9234-7b4a-be61-d845564ddbc1"],
 ".\nWe re-express it using only the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "098b4ab0-37fb-5b47-ac69-3cd514e92bb2"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4a299e16-4eef-fd4b-ad88-e00124c3be96"],
 " and get"
}], "Text",
 CellChangeTimes->{{3.9625713351905212`*^9, 3.9625713566725883`*^9}, {
  3.9625870278413944`*^9, 3.9625870451057816`*^9}, {3.9625870814407196`*^9, 
  3.9625871158182316`*^9}},ExpressionUUID->"ffa5a7a2-4262-724e-a3f5-\
d41f4eb1d79d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Var", "[", 
      SubscriptBox["Nb", "1"], "]"}], "+", 
     RowBox[{"Var", "[", 
      SubscriptBox["Nb", "2"], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T1", "->", 
       RowBox[{"1", "-", "R1"}]}], ",", 
      RowBox[{"T2", "->", 
       RowBox[{"1", "-", "R2"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
  "MySimplify"}]], "Input",
 CellChangeTimes->{{3.9625863388301105`*^9, 3.9625863920658493`*^9}, {
  3.9625871041256104`*^9, 3.9625871191157055`*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"4a744bc9-7515-114c-a1b5-48f3c294c90d"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.962586342520262*^9, 3.962586392602438*^9}, 
   3.9625871224682655`*^9, 3.96346478040571*^9, 3.963800252148136*^9, 
   3.9638003299340687`*^9, 3.96440742756441*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"52c9d514-eaf8-49f4-aa3d-c5f45764e048"]
}, Open  ]],

Cell["\<\
The expectation value of the difference of photon numbers is given by\
\>", "Text",
 CellChangeTimes->{{3.9625871543454494`*^9, 
  3.96258717327297*^9}},ExpressionUUID->"c4e410f5-d27f-3748-b85d-\
608d3f97f4fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"VEV", "[", 
   RowBox[{
    SubscriptBox["Nb", "1"], "-", 
    SubscriptBox["Nb", "2"]}], "]"}], "//", "MySimplify"}]], "Input",
 CellChangeTimes->{{3.962570341637516*^9, 3.9625703535553894`*^9}, {
  3.962570390100216*^9, 3.9625704019858875`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"b4c642bf-2011-be4c-8f08-30968ca2fe9a"],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalN]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"R1", " ", 
     RowBox[{"(", 
      RowBox[{"R2", "-", "T2"}], ")"}]}], "+", 
    RowBox[{"T1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "R2"}], "+", "T2"}], ")"}], " ", 
     SuperscriptBox["\[Tau]", "2"]}], "+", 
    RowBox[{"4", " ", 
     SqrtBox[
      RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", "\[Tau]", " ", 
     RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.962570354837578*^9, {3.9625703958730774`*^9, 3.962570403147114*^9}},
 CellLabel->
  "Out[182]=",ExpressionUUID->"184fd15a-5e23-2247-8b4b-3c1e7d770c05"]
}, Open  ]],

Cell["\<\
It can also be evaluated using the transformed coherent numbers\
\>", "Text",
 CellChangeTimes->{{3.9625871774211655`*^9, 
  3.9625871985050087`*^9}},ExpressionUUID->"a18a4a67-6b8c-724f-8725-\
8dfd92f18b86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       SubscriptBox["beta", "1"], ")"}], "\[Conjugate]"}], 
     RowBox[{"(", 
      SubscriptBox["beta", "1"], ")"}]}], "-", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       SubscriptBox["beta", "2"], ")"}], "\[Conjugate]"}], 
     RowBox[{"(", 
      SubscriptBox["beta", "2"], ")"}]}]}], "//", "Refine"}], "//", 
  "MySimplify"}]], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"36341c72-76bc-ba4d-a0c5-06cfde9e11b5"],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalN]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"R1", " ", 
     RowBox[{"(", 
      RowBox[{"R2", "-", "T2"}], ")"}]}], "+", 
    RowBox[{"T1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "R2"}], "+", "T2"}], ")"}], " ", 
     SuperscriptBox["\[Tau]", "2"]}], "+", 
    RowBox[{"4", " ", 
     SqrtBox[
      RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", "\[Tau]", " ", 
     RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.962587271256693*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"9d46a16c-f09d-1049-a94c-17d4602cd919"]
}, Open  ]],

Cell["We take the derivative with respect to the phase and get", "Text",
 CellChangeTimes->{{3.9625872857530136`*^9, 
  3.962587296584648*^9}},ExpressionUUID->"d9bf5e86-4007-614a-919e-\
0e2d3d694854"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"\[ScriptCapitalN]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"R1", " ", 
       RowBox[{"(", 
        RowBox[{"R2", "-", "T2"}], ")"}]}], "+", 
      RowBox[{"T1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "R2"}], "+", "T2"}], ")"}], " ", 
       SuperscriptBox["\[Tau]", "2"]}], "+", 
      RowBox[{"4", " ", 
       SqrtBox[
        RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", "\[Tau]", " ", 
       RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}]}], ")"}]}], ",", 
   "\[CurlyPhi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9625704273004456`*^9, 3.9625704521915207`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"e4d83a65-653e-8546-b606-512174aa4a87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SqrtBox[
   RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", "\[ScriptCapitalN]",
   " ", "\[Tau]", " ", 
  RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]], "Output",
 CellChangeTimes->{3.9625873100404434`*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"5e1ad4c2-4964-a94b-a62c-e0dbd03b4c65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     SqrtBox[
      RowBox[{"R1", " ", "R2", " ", "T1", " ", "T2"}]], " ", 
     "\[ScriptCapitalN]", " ", "\[Tau]", " ", 
     RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T1", "->", 
       RowBox[{"1", "-", "R1"}]}], ",", 
      RowBox[{"T2", "->", 
       RowBox[{"1", "-", "R2"}]}]}], "}"}]}], "//", "Simplify"}], "//", 
  "MySimplify"}]], "Input",
 CellChangeTimes->{{3.962586445279768*^9, 3.9625864452824745`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"438e0b82-3f9c-f84c-a69d-df11fd0541a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SqrtBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "R1"}], ")"}], " ", "R1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "R2"}], ")"}], " ", "R2"}]], " ", 
  "\[ScriptCapitalN]", " ", "\[Tau]", " ", 
  RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]], "Output",
 CellChangeTimes->{3.9625864469293766`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"1879ec19-1272-bd43-b836-060c649b0adf"]
}, Open  ]],

Cell["The sensitivity is therefore:", "Text",
 CellChangeTimes->{{3.9625704610006695`*^9, 
  3.962570466913513*^9}},ExpressionUUID->"80a301af-7cae-8649-b37e-\
11dae3f26839"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ScriptCapitalN]", " ", 
    RowBox[{"(", 
     RowBox[{"R1", "+", 
      SuperscriptBox["\[Tau]", "2"], "-", 
      RowBox[{"R1", " ", 
       SuperscriptBox["\[Tau]", "2"]}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R1"}], ")"}], " ", "R1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R2"}], ")"}], " ", "R2"}]], " ", 
      "\[ScriptCapitalN]", " ", "\[Tau]", " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ")"}], "2"]], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.9625864212968597`*^9, 3.962586468865488*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"5e893fe1-b35a-1f4b-b5aa-c84a2a127e38"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"R1", "+", 
     SuperscriptBox["\[Tau]", "2"], "-", 
     RowBox[{"R1", " ", 
      SuperscriptBox["\[Tau]", "2"]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Csc", "[", "\[CurlyPhi]", "]"}], "2"]}], 
  RowBox[{"16", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "R1"}], ")"}], " ", "R1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "R2"}], ")"}], " ", "R2", " ", 
   "\[ScriptCapitalN]", " ", 
   SuperscriptBox["\[Tau]", "2"]}]]], "Output",
 CellChangeTimes->{3.962586469438509*^9},
 CellLabel->
  "Out[202]=",ExpressionUUID->"3112e561-acfb-1341-b658-3af77c27ff5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Minimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"R1", "+", 
          SuperscriptBox["\[Tau]", "2"], "-", 
          RowBox[{"R1", " ", 
           SuperscriptBox["\[Tau]", "2"]}]}], ")"}], " "}], 
       RowBox[{"16", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R1"}], ")"}], " ", "R1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R2"}], ")"}], " ", "R2", "  ", 
        SuperscriptBox["\[Tau]", "2"]}]], ",", 
      RowBox[{"0", "<=", "R1", "<=", "1"}], ",", 
      RowBox[{"0", "<=", "R2", "<=", "1"}], ",", 
      RowBox[{"0", "<=", "\[Tau]", "<=", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"R1", ",", "R2"}], "}"}]}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.962586482247484*^9, 3.9625865334900475`*^9}, {
  3.962587343537981*^9, 3.962587344912615*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"0e334155-0124-1344-bade-a1d14dc31a4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Tau]"}], ")"}], "2"], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Tau]", "2"]}]], 
          RowBox[{"\[Tau]", ">", "0"}]},
         {"\[Infinity]", 
          TagBox["True",
           "PiecewiseDefault",
           AutoDelete->True]}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}},
        Selectable->True]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False,
    StripWrapperBoxes->True], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R1", "\[Rule]", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             FractionBox["\[Tau]", 
              RowBox[{"1", "+", "\[Tau]"}]], 
             RowBox[{"\[Tau]", ">", "0"}]},
            {"Indeterminate", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
           GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}},
           Selectable->True]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False,
       StripWrapperBoxes->True]}], ",", 
     RowBox[{"R2", "\[Rule]", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             FractionBox["1", "2"], 
             RowBox[{"\[Tau]", ">", "0"}]},
            {"Indeterminate", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
           GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}},
           Selectable->True]}
        },
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False,
       StripWrapperBoxes->True]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.962586534460182*^9, 3.9625873454060364`*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"86e50002-5972-5149-9c9d-6242c8852b3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R1", "+", 
       SuperscriptBox["\[Tau]", "2"], "-", 
       RowBox[{"R1", " ", 
        SuperscriptBox["\[Tau]", "2"]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Csc", "[", "\[CurlyPhi]", "]"}], "2"]}], 
    RowBox[{"16", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R1"}], ")"}], " ", "R1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R2"}], ")"}], " ", "R2", " ", 
     "\[ScriptCapitalN]", " ", 
     SuperscriptBox["\[Tau]", "2"]}]], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R1", "->", 
      FractionBox["\[Tau]", 
       RowBox[{"1", "+", "\[Tau]"}]]}], ",", 
     RowBox[{"R2", "->", 
      FractionBox["1", "2"]}], ",", 
     RowBox[{"\[CurlyPhi]", "->", 
      FractionBox["\[Pi]", "2"]}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.962586558771803*^9, 3.962586613809149*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"6e1ea930-3c1e-c642-a95e-6b21668a2f17"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", "\[Tau]"}], ")"}], "2"], 
  RowBox[{"4", " ", "\[ScriptCapitalN]", " ", 
   SuperscriptBox["\[Tau]", "2"]}]]], "Output",
 CellChangeTimes->{{3.962586609237566*^9, 3.9625866142473927`*^9}},
 CellLabel->
  "Out[205]=",ExpressionUUID->"afd1e0f1-b89c-d04c-819c-9516b332a92a"]
}, Open  ]],

Cell["In the lossless case:", "Text",
 CellChangeTimes->{{3.9625706133700867`*^9, 
  3.9625706215046616`*^9}},ExpressionUUID->"c43c22a8-7a9d-7f49-811a-\
f4fa7fa145eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Tau]"}], ")"}], "2"], 
    RowBox[{"4", " ", "\[ScriptCapitalN]", " ", 
     SuperscriptBox["\[Tau]", "2"]}]], "/.", 
   RowBox[{"\[Tau]", "->", "1"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.962570628488636*^9, 3.9625706333103466`*^9}, {
  3.962587391506302*^9, 3.9625874061850567`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"900cfbd6-ba71-5e4d-9033-b1cf58d541f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
General Phase sensitivity for coherent state input  with average number of \
photons \[Mu],\[Nu]\
\>", "Subsection",
 CellChangeTimes->{{3.9711628462416506`*^9, 
  3.9711629405296655`*^9}},ExpressionUUID->"a589842e-75fd-4fad-8fa9-\
3421d741eb16"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SensCoherent", "[", 
    RowBox[{
    "T_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "tO_", ",", "\[CurlyPhi]_"}], 
    "]"}], ":=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["tO", "2"]}], ")"}], " ", 
        SqrtBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "T"}], ")"}], " ", "T", " ", "\[Mu]", 
            " ", "\[Nu]"}], ")"}]}]]}], "+", 
       RowBox[{"T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["tO", "2"], " ", "\[Mu]"}], "+", "\[Nu]"}], ")"}]}],
        "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "T"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Mu]", "+", 
          RowBox[{
           SuperscriptBox["tO", "2"], " ", "\[Nu]"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Csc", "[", "\[CurlyPhi]", "]"}], "2"]}], 
    RowBox[{"16", " ", 
     SuperscriptBox["tO", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "T"}], ")"}], " ", "T", " ", "\[Mu]"}], 
        "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "T"}], ")"}], " ", "T", " ", "\[Nu]"}], 
        "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "T"}]}], ")"}], " ", 
         SqrtBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "T"}], ")"}], " ", "T", " ", "\[Mu]", 
             " ", "\[Nu]"}], ")"}]}]]}]}], ")"}], "2"]}]]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.963456800562301*^9, 3.9634568431818542`*^9}, {
   3.963467563330036*^9, 3.963467586392533*^9}, {3.9634676267903814`*^9, 
   3.9634676364459734`*^9}, {3.9634676788259163`*^9, 3.963467696992982*^9}, {
   3.964689383029376*^9, 3.964689419378991*^9}, {3.964689467538433*^9, 
   3.9646894743103876`*^9}, {3.964689770809454*^9, 3.964689778317112*^9}, {
   3.964690670839328*^9, 3.96469070279247*^9}, 
   3.9711629630840855`*^9},ExpressionUUID->"bf06afc8-203f-409e-9e2f-\
a63e7c8ccc58"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
InputAliases->{
 "on" -> "\[CenterDot]", "tp" -> "\[CircleTimes]", "op" -> 
  OverscriptBox["\[Placeholder]", "^"], "her" -> SuperscriptBox[
    RowBox[{"(", "\[Placeholder]", ")"}], "\[Dagger]"], "con" -> 
  SuperscriptBox[
    RowBox[{"(", "\[Placeholder]", ")"}], "*"], "comm" -> TagBox[
    SubscriptBox[
     RowBox[{"\[LeftDoubleBracket]", 
       TagBox[
        RowBox[{"\[Placeholder]", ",", "\[Placeholder]"}], 
        Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
       "\[RightDoubleBracket]"}], "-"], Quantum`Notation`zz050Commutator, 
    Editable -> False, Selectable -> False], "anti" -> TagBox[
    SubscriptBox[
     RowBox[{"\[LeftDoubleBracket]", 
       TagBox[
        RowBox[{"\[Placeholder]", ",", "\[Placeholder]"}], 
        Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True], 
       "\[RightDoubleBracket]"}], "+"], Quantum`Notation`zz050AntiCommutator, 
    Editable -> False, Selectable -> False], "ket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
       Selectable -> True, BaseStyle -> {ShowSyntaxStyles -> True}], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> False, 
    Selectable -> False, BaseStyle -> {ShowSyntaxStyles -> False}], "ev" -> 
  SubscriptBox["\[Placeholder]", 
    OverscriptBox["\[Placeholder]", "^"]], "eval" -> 
  SubscriptBox["\[Placeholder]", 
    OverscriptBox["\[Placeholder]", "^"]], "eket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "eeket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "eeeket" -> TagBox[
    RowBox[{"\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "braket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080BraArgs, Editable -> True, 
       Selectable -> True, BaseStyle -> {ShowSyntaxStyles -> True}], 
      "\[VerticalSeparator]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
       Selectable -> True, BaseStyle -> {ShowSyntaxStyles -> True}], 
      "\[RightAngleBracket]"}], Quantum`Notation`zz080BraKet, Editable -> 
    False, Selectable -> False, BaseStyle -> {ShowSyntaxStyles -> False}], 
  "ebraket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080BraKet, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "eebraket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080BraKet, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "eeebraket" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
    Quantum`Notation`zz080BraKet, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "bra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz080BraArgs, Editable -> True, 
       Selectable -> True, BaseStyle -> {ShowSyntaxStyles -> True}], 
      "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> False, 
    Selectable -> False, BaseStyle -> {ShowSyntaxStyles -> False}], "ebra" -> 
  TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]"}], 
    Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "eebra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]"}], 
    Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "eeebra" -> TagBox[
    RowBox[{"\[LeftAngleBracket]", 
      TagBox[
       RowBox[{
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], ",", 
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]]}], 
       Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
       BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]"}], 
    Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False, 
    BaseStyle -> {ShowSyntaxStyles -> False}], "norm" -> 
  RowBox[{"\[LeftDoubleBracketingBar]", "\[Placeholder]", 
     "\[RightDoubleBracketingBar]"}], "trace" -> RowBox[{
     SubscriptBox["Tr", 
      OverscriptBox["\[Placeholder]", "^"]], "[", "\[Placeholder]", "]"}], 
  "ketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
        "\[Placeholder]", Quantum`Notation`zz080KetArgs, Editable -> True, 
         Selectable -> True, BaseStyle -> {ShowSyntaxStyles -> True}], 
        "\[RightAngleBracket]"}], Quantum`Notation`zz080Ket, Editable -> 
      False, Selectable -> False, BaseStyle -> {ShowSyntaxStyles -> False}], 
     "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
        "\[Placeholder]", Quantum`Notation`zz080BraArgs, Editable -> True, 
         Selectable -> True, BaseStyle -> {ShowSyntaxStyles -> True}], 
        "\[VerticalSeparator]"}], Quantum`Notation`zz080Bra, Editable -> 
      False, Selectable -> False, BaseStyle -> {ShowSyntaxStyles -> False}]}],
   "eketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], 
         Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
         BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
      Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False, 
      BaseStyle -> {ShowSyntaxStyles -> False}], "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         SubscriptBox["\[Placeholder]", 
          OverscriptBox["\[Placeholder]", "^"]], 
         Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
         BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]"}], 
      Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False, 
      BaseStyle -> {ShowSyntaxStyles -> False}]}], "eeketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
         BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
      Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False, 
      BaseStyle -> {ShowSyntaxStyles -> False}], "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
         BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]"}], 
      Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False, 
      BaseStyle -> {ShowSyntaxStyles -> False}]}], "eeeketbra" -> RowBox[{
     TagBox[
      RowBox[{"\[VerticalSeparator]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080KetArgs, Editable -> True, Selectable -> True, 
         BaseStyle -> {ShowSyntaxStyles -> True}], "\[RightAngleBracket]"}], 
      Quantum`Notation`zz080Ket, Editable -> False, Selectable -> False, 
      BaseStyle -> {ShowSyntaxStyles -> False}], "\[CenterDot]", 
     TagBox[
      RowBox[{"\[LeftAngleBracket]", 
        TagBox[
         RowBox[{
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]], ",", 
           SubscriptBox["\[Placeholder]", 
            OverscriptBox["\[Placeholder]", "^"]]}], 
         Quantum`Notation`zz080BraArgs, Editable -> True, Selectable -> True, 
         BaseStyle -> {ShowSyntaxStyles -> True}], "\[VerticalSeparator]"}], 
      Quantum`Notation`zz080Bra, Editable -> False, Selectable -> False, 
      BaseStyle -> {ShowSyntaxStyles -> False}]}], "su" -> 
  SubscriptBox["\[Placeholder]", "\[Placeholder]"], "po" -> SuperscriptBox[
    RowBox[{"(", "\[Placeholder]", ")"}], "\[Placeholder]"], "pow" -> 
  SuperscriptBox[
    RowBox[{"(", "\[Placeholder]", ")"}], "\[Placeholder]"], "si" -> RowBox[{
     UnderoverscriptBox["\[Sum]", "\[Placeholder]", "\[Placeholder]"], 
     "\[Placeholder]"}], "qs" -> RowBox[{
     UnderoverscriptBox["\[Sum]", "\[Placeholder]", "\[Placeholder]"], 
     "\[Placeholder]"}], "qp" -> TagBox[
    RowBox[{
      UnderoverscriptBox["\[CircleTimes]", 
       TagBox[
       "\[Placeholder]", Quantum`Notation`zz020TPNotationini, Editable -> 
        True, Selectable -> True], 
       TagBox[
       "\[Placeholder]", Quantum`Notation`zz020TPNotationend, Editable -> 
        True, Selectable -> True]], 
      TagBox[
      "\[Placeholder]", Quantum`Notation`zz020TPNotationdat, Editable -> True,
        Selectable -> True]}], Quantum`Notation`zz020TPNotation, Editable -> 
    False, Selectable -> False]},
Magnification:>1. Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4202aeda-3875-2643-baaf-174014dec6da"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 253, 4, 98, "Title",ExpressionUUID->"6f2e34dd-c865-574f-8d42-ce6a44c76a97"],
Cell[832, 28, 281, 5, 35, "Text",ExpressionUUID->"5cf2beed-82cd-a947-85d2-8e59f61168db"],
Cell[1116, 35, 303, 6, 28, "Input",ExpressionUUID->"5304e165-6b52-c348-b3e0-6cb55a8ad531"],
Cell[1422, 43, 345, 7, 35, "Text",ExpressionUUID->"7ea7ecf5-e658-9e48-bfd2-b9fa81746cc1"],
Cell[1770, 52, 627, 16, 30, "Input",ExpressionUUID->"d5ccd494-7a74-6b45-a423-502dbf4a113b"],
Cell[2400, 70, 420, 8, 35, "Text",ExpressionUUID->"f0cb0ebf-639d-f940-bad1-2db7f2568499"],
Cell[2823, 80, 572, 16, 31, "Input",ExpressionUUID->"8fecdd1d-19f3-b04a-8a8d-4019ff377048"],
Cell[3398, 98, 496, 9, 35, "Text",ExpressionUUID->"ce6db00c-40cb-854e-bf35-8196d8ad643c"],
Cell[3897, 109, 681, 15, 28, "Input",ExpressionUUID->"d3af0d0c-3305-934b-8da3-53e4706d6cd8"],
Cell[4581, 126, 581, 11, 35, "Text",ExpressionUUID->"17ae813a-e6b4-0042-af6f-1d961e361e2d"],
Cell[5165, 139, 651, 18, 28, "Input",ExpressionUUID->"eadb7f4c-8f08-054e-8475-baa50b7bdf75"],
Cell[5819, 159, 298, 7, 28, "Input",ExpressionUUID->"15d89ab4-0c43-ba4d-a561-2e6f1a5bc86d"],
Cell[6120, 168, 906, 25, 71, "Input",ExpressionUUID->"2322cf5a-345d-1841-bb4b-97cb2de62e4c"],
Cell[CellGroupData[{
Cell[7051, 197, 209, 4, 28, "Input",ExpressionUUID->"df8686ca-3f89-c44d-9e11-c81b80116ae6"],
Cell[7263, 203, 900, 26, 78, "Output",ExpressionUUID->"82701a33-a98e-400d-8571-bb616dc5c840"]
}, Open  ]],
Cell[8178, 232, 251, 6, 28, "Input",ExpressionUUID->"3d7e5c28-8881-0544-a83a-be6d8cd970da"],
Cell[CellGroupData[{
Cell[8454, 242, 267, 4, 64, "Subchapter",ExpressionUUID->"55ce9900-c65b-5b44-9af7-c1587593403c"],
Cell[8724, 248, 402, 12, 43, "Input",ExpressionUUID->"1679bb83-f99b-4a45-bc01-1fdd92b51eec"],
Cell[9129, 262, 309, 8, 28, "Input",ExpressionUUID->"e2b49c80-e67e-4244-8f62-45e81f3f60b0"],
Cell[9441, 272, 450, 13, 43, "Input",ExpressionUUID->"81841688-c4de-1e45-a5ba-14bf2fdc74c8"],
Cell[9894, 287, 309, 8, 28, "Input",ExpressionUUID->"54624dbb-239a-294c-b0bb-aae8d02ab18c"],
Cell[CellGroupData[{
Cell[10228, 299, 343, 8, 28, "Input",ExpressionUUID->"158cb033-5521-414e-8ecd-26efbac44f4b"],
Cell[10574, 309, 874, 24, 78, "Output",ExpressionUUID->"0ca83c7f-e92e-4fab-a459-16eecb2c4690"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11485, 338, 328, 9, 28, "Input",ExpressionUUID->"59c1afe6-7b81-a14e-b9f4-76f83b0b4325"],
Cell[11816, 349, 872, 24, 78, "Output",ExpressionUUID->"564083ed-4065-41c3-8548-eda61bd3e0e8"]
}, Open  ]],
Cell[12703, 376, 818, 24, 60, "Input",ExpressionUUID->"a5588c37-ce57-5c49-9ca6-75e18ff59987"],
Cell[13524, 402, 1189, 30, 64, "Input",ExpressionUUID->"eeb940d2-dcde-5447-8105-bca944a24c15"],
Cell[CellGroupData[{
Cell[14738, 436, 632, 20, 60, "Input",ExpressionUUID->"cdbf7a85-9e45-0647-9785-b3f8debdbf04"],
Cell[15373, 458, 1308, 40, 88, "Output",ExpressionUUID->"24ba0101-6ae3-413d-b107-f2348e2e1527"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16718, 503, 370, 11, 38, "Input",ExpressionUUID->"ea7f0faa-b083-db47-9be9-d33ff5905eb9"],
Cell[17091, 516, 1029, 30, 88, "Output",ExpressionUUID->"d01609e3-5aae-4a79-b4e5-ed99872c4499"]
}, Open  ]],
Cell[18135, 549, 1009, 30, 73, "Input",ExpressionUUID->"a42e6bf3-4518-c34c-a848-854ce69df80b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19181, 584, 224, 4, 69, "Chapter",ExpressionUUID->"09af0663-be78-9343-94c6-4507d771eed1"],
Cell[19408, 590, 1945, 41, 48, "Input",ExpressionUUID->"db1b6950-af52-d44e-93e2-d99012b1a644"],
Cell[21356, 633, 800, 18, 28, "Input",ExpressionUUID->"f572c662-003d-af43-9333-4023e7ebb7dd"],
Cell[22159, 653, 647, 17, 28, "Input",ExpressionUUID->"b4b890db-7603-134e-a95a-2508fdd89866"],
Cell[22809, 672, 345, 10, 37, "Input",ExpressionUUID->"baed7346-dfc5-b64d-a39c-e37c73b7c323"],
Cell[23157, 684, 351, 10, 37, "Input",ExpressionUUID->"33b2e67b-790e-cf43-9594-31574af65298"],
Cell[23511, 696, 616, 17, 28, "Input",ExpressionUUID->"db0fa99c-ca35-3647-a8c5-861f05f41516"],
Cell[24130, 715, 641, 18, 28, "Input",ExpressionUUID->"088c8aec-9658-c546-88c1-6ee77979e4c0"],
Cell[24774, 735, 427, 13, 37, "Input",ExpressionUUID->"de6bad6b-a9aa-6248-9df2-14445cc716fd"],
Cell[25204, 750, 431, 13, 37, "Input",ExpressionUUID->"4e887d77-9bd8-ea41-bbbb-e63892ef43bd"],
Cell[CellGroupData[{
Cell[25660, 767, 266, 6, 28, "Input",ExpressionUUID->"d160f9e2-7630-604a-9cbb-c88b94437f52"],
Cell[25929, 775, 2982, 91, 98, "Output",ExpressionUUID->"e5c5af31-9476-4a8d-ae37-6b09f50fd588"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28948, 871, 305, 8, 28, "Input",ExpressionUUID->"882994b2-1d3d-1f41-9e79-1975510d707f"],
Cell[29256, 881, 1098, 33, 38, "Output",ExpressionUUID->"6f6dbd4c-c6a3-4bdc-9512-9ff849e3b4ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30391, 919, 268, 6, 28, "Input",ExpressionUUID->"f8378790-fc89-a04e-87de-b1b1348a4951"],
Cell[30662, 927, 3725, 117, 101, "Output",ExpressionUUID->"27d80889-f686-411d-8119-a04785df541a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34424, 1049, 266, 6, 28, "Input",ExpressionUUID->"12223896-5f9d-0c47-8bbe-9003bd6567e3"],
Cell[34693, 1057, 2719, 85, 94, "Output",ExpressionUUID->"1973eb18-e393-4ddf-b6ca-7a6f145586a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37449, 1147, 265, 6, 28, "Input",ExpressionUUID->"ccdabe24-b502-8640-927b-86d0badf577a"],
Cell[37717, 1155, 3701, 117, 101, "Output",ExpressionUUID->"feb52988-7ae0-4091-a50f-b1dca5ae93b6"]
}, Open  ]],
Cell[41433, 1275, 480, 13, 30, "Input",ExpressionUUID->"ff88eb87-1515-1044-a011-0e7d0fe12519"],
Cell[41916, 1290, 436, 12, 30, "Input",ExpressionUUID->"423562d1-8fd4-bb4c-bb22-1640a6327f38"],
Cell[42355, 1304, 386, 11, 30, "Input",ExpressionUUID->"e9deda4f-6872-9d49-81b6-3be400989180"],
Cell[42744, 1317, 461, 13, 30, "Input",ExpressionUUID->"3325963c-e4bb-834a-b06e-85f53c534815"],
Cell[43208, 1332, 413, 12, 30, "Input",ExpressionUUID->"32b72046-8361-5245-8f24-5d159ef69501"],
Cell[CellGroupData[{
Cell[43646, 1348, 516, 14, 28, "Input",ExpressionUUID->"04b8ff5c-4a04-e641-9639-93bdc7598452"],
Cell[44165, 1364, 1560, 47, 36, "Output",ExpressionUUID->"f14c5466-a930-4492-b1d4-b175209241f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45762, 1416, 232, 4, 64, "Subchapter",ExpressionUUID->"5dbefad7-cf1d-0c4c-a0cf-d28dc1fd4d16"],
Cell[45997, 1422, 350, 8, 48, "Input",ExpressionUUID->"f39d6875-f450-eb46-af6a-1eb6d8ff3965"],
Cell[CellGroupData[{
Cell[46372, 1434, 224, 4, 45, "Subsubsection",ExpressionUUID->"ded2464f-b4de-a843-9f63-1c8c6bda389d"],
Cell[46599, 1440, 2842, 78, 37, "Input",ExpressionUUID->"4e5ecc33-6c31-9845-9da0-2851497e80bc"],
Cell[49444, 1520, 2859, 79, 37, "Input",ExpressionUUID->"8916f029-9074-f545-9d94-9cbe00efd7b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52340, 1604, 269, 4, 45, "Subsubsection",ExpressionUUID->"d66ef25e-fd3d-414b-a487-10c669d188d6"],
Cell[52612, 1610, 1681, 52, 50, "Input",ExpressionUUID->"e143077f-de5a-f84d-b799-f0e95ad5d7c0"],
Cell[CellGroupData[{
Cell[54318, 1666, 426, 13, 29, "Input",ExpressionUUID->"61447260-397c-4e4e-b3cf-13a378237cff"],
Cell[54747, 1681, 909, 26, 35, "Output",ExpressionUUID->"b77f923b-f9f9-4311-9e0e-af4f862a5a32"]
}, Open  ]],
Cell[55671, 1710, 164, 3, 35, "Text",ExpressionUUID->"de156ce5-2907-d043-b287-ad8c64e968e9"],
Cell[55838, 1715, 294, 9, 30, "Input",ExpressionUUID->"1ea9932e-6dbf-8c48-aab4-04ab64c08830"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56169, 1729, 178, 3, 45, "Subsubsection",ExpressionUUID->"ec75e505-afdd-154d-aba4-881f5ad52190"],
Cell[56350, 1734, 1204, 33, 48, "Input",ExpressionUUID->"bed37845-f1c7-ee49-9869-53101e069eec"],
Cell[57557, 1769, 1417, 39, 57, "Input",ExpressionUUID->"cbea875d-77f3-4a44-9a9a-77eaa597154c"],
Cell[58977, 1810, 576, 16, 28, "Input",ExpressionUUID->"944a7a6f-ffad-8148-b4b6-1b653d330002"],
Cell[59556, 1828, 340, 8, 28, "Input",ExpressionUUID->"4c7cd41c-ae78-5d4d-acab-8496241ea7c3"],
Cell[59899, 1838, 2087, 50, 111, "Input",ExpressionUUID->"3185140d-50fe-604b-960a-3d368bbbd00e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62023, 1893, 406, 6, 45, "Subsubsection",ExpressionUUID->"0415d5f2-affa-fc4f-8cd7-c1fb424b6b8c"],
Cell[62432, 1901, 1039, 30, 29, "Input",ExpressionUUID->"7600702a-66eb-1848-831a-06ed72795091"],
Cell[63474, 1933, 521, 14, 31, "Input",ExpressionUUID->"909d8956-89ff-9c4e-95a0-d212a630082e"],
Cell[63998, 1949, 578, 16, 28, "Input",ExpressionUUID->"7d6e6b66-2005-734e-9e84-832c748c9bba"],
Cell[64579, 1967, 517, 15, 48, "Input",ExpressionUUID->"f0ad9b20-d71e-744c-a888-3a355ab30272"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65133, 1987, 329, 5, 45, "Subsubsection",ExpressionUUID->"5e78bbcc-dbe4-cc4a-b0ee-950a9412c5f7"],
Cell[65465, 1994, 255, 6, 35, "Text",ExpressionUUID->"3b4171a8-a27f-3242-9bf2-14ebf5638efc"],
Cell[CellGroupData[{
Cell[65745, 2004, 347, 9, 28, "Input",ExpressionUUID->"06e9b526-a8e0-854a-963b-8c34620f5504"],
Cell[66095, 2015, 1103, 32, 36, "Output",ExpressionUUID->"22ad005b-1695-44d4-94a3-9d92e63e7645"]
}, Open  ]],
Cell[67213, 2050, 215, 5, 35, "Text",ExpressionUUID->"cdee7aca-3a19-3e45-9700-a81ed62fd3d3"],
Cell[CellGroupData[{
Cell[67453, 2059, 570, 19, 28, "Input",ExpressionUUID->"c2fb70dc-147c-cd49-8714-fa25d3d32d37"],
Cell[68026, 2080, 2784, 88, 58, "Output",ExpressionUUID->"ff62e6fe-387e-44f7-9b56-2fc19279231a"]
}, Open  ]],
Cell[70825, 2171, 240, 4, 35, "Text",ExpressionUUID->"94252309-bb53-334d-90d4-2bd47d9187f5"],
Cell[CellGroupData[{
Cell[71090, 2179, 310, 8, 28, "Input",ExpressionUUID->"831c72d9-aeee-0742-b0b8-7196f941e37f"],
Cell[71403, 2189, 3859, 115, 96, "Output",ExpressionUUID->"81c90cdd-7d57-4a57-8c22-ed51427b120b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75299, 2309, 1454, 45, 37, "Input",ExpressionUUID->"5b788661-7999-dc43-ae9e-de11c0db582a"],
Cell[76756, 2356, 278, 5, 32, "Output",ExpressionUUID->"1287db81-bec3-404b-8114-39a399369ca3"]
}, Open  ]],
Cell[77049, 2364, 1245, 38, 58, "Text",ExpressionUUID->"ffa5a7a2-4262-724e-a3f5-d41f4eb1d79d"],
Cell[CellGroupData[{
Cell[78319, 2406, 636, 19, 28, "Input",ExpressionUUID->"4a744bc9-7515-114c-a1b5-48f3c294c90d"],
Cell[78958, 2427, 300, 4, 32, "Output",ExpressionUUID->"52c9d514-eaf8-49f4-aa3d-c5f45764e048"]
}, Open  ]],
Cell[79273, 2434, 220, 5, 35, "Text",ExpressionUUID->"c4e410f5-d27f-3748-b85d-608d3f97f4fc"],
Cell[CellGroupData[{
Cell[79518, 2443, 365, 9, 28, "Input",ExpressionUUID->"b4c642bf-2011-be4c-8f08-30968ca2fe9a"],
Cell[79886, 2454, 685, 19, 36, "Output",ExpressionUUID->"184fd15a-5e23-2247-8b4b-3c1e7d770c05"]
}, Open  ]],
Cell[80586, 2476, 217, 5, 35, "Text",ExpressionUUID->"a18a4a67-6b8c-724f-8725-8dfd92f18b86"],
Cell[CellGroupData[{
Cell[80828, 2485, 526, 18, 28, "Input",ExpressionUUID->"36341c72-76bc-ba4d-a0c5-06cfde9e11b5"],
Cell[81357, 2505, 634, 18, 36, "Output",ExpressionUUID->"9d46a16c-f09d-1049-a94c-17d4602cd919"]
}, Open  ]],
Cell[82006, 2526, 200, 3, 35, "Text",ExpressionUUID->"d9bf5e86-4007-614a-919e-0e2d3d694854"],
Cell[CellGroupData[{
Cell[82231, 2533, 755, 21, 37, "Input",ExpressionUUID->"e4d83a65-653e-8546-b606-512174aa4a87"],
Cell[82989, 2556, 349, 9, 33, "Output",ExpressionUUID->"5e1ad4c2-4964-a94b-a62c-e0dbd03b4c65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83375, 2570, 648, 19, 31, "Input",ExpressionUUID->"438e0b82-3f9c-f84c-a69d-df11fd0541a6"],
Cell[84026, 2591, 495, 15, 33, "Output",ExpressionUUID->"1879ec19-1272-bd43-b836-060c649b0adf"]
}, Open  ]],
Cell[84536, 2609, 173, 3, 35, "Text",ExpressionUUID->"80a301af-7cae-8649-b37e-11dae3f26839"],
Cell[CellGroupData[{
Cell[84734, 2616, 867, 26, 61, "Input",ExpressionUUID->"5e893fe1-b35a-1f4b-b5aa-c84a2a127e38"],
Cell[85604, 2644, 683, 21, 55, "Output",ExpressionUUID->"3112e561-acfb-1341-b658-3af77c27ff5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86324, 2670, 1068, 29, 53, "Input",ExpressionUUID->"0e334155-0124-1344-bade-a1d14dc31a4a"],
Cell[87395, 2701, 4639, 129, 59, "Output",ExpressionUUID->"86e50002-5972-5149-9c9d-6242c8852b3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92071, 2835, 1065, 32, 53, "Input",ExpressionUUID->"6e1ea930-3c1e-c642-a95e-6b21668a2f17"],
Cell[93139, 2869, 356, 9, 52, "Output",ExpressionUUID->"afd1e0f1-b89c-d04c-819c-9516b332a92a"]
}, Open  ]],
Cell[93510, 2881, 167, 3, 35, "Text",ExpressionUUID->"c43c22a8-7a9d-7f49-811a-f4fa7fa145eb"],
Cell[93680, 2886, 502, 13, 49, "Input",ExpressionUUID->"900cfbd6-ba71-5e4d-9033-b1cf58d541f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94219, 2904, 256, 6, 54, "Subsection",ExpressionUUID->"a589842e-75fd-4fad-8fa9-3421d741eb16"],
Cell[94478, 2912, 2553, 76, 91, "Input",ExpressionUUID->"bf06afc8-203f-409e-9e2f-a63e7c8ccc58"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

